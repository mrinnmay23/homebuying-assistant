<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <title>Mortgage Chatbot</title>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Mortgage Chatbot</h1>-->
<!--<a th:href="@{/}">&larr; Home</a>-->
<!--<form id="chat-form">-->
<!--    <input-->
<!--            type="text"-->
<!--            id="msg"-->
<!--            placeholder="Type your question…"-->
<!--            autocomplete="off"-->
<!--            style="width: 300px;"-->
<!--    />-->
<!--    <button type="submit">Send</button>-->
<!--</form>-->

<!--<pre id="log" style="margin-top: 1em; background: #f5f5f5; padding: 1em;"></pre>-->

<!--&lt;!&ndash; inline script to catch the submit and POST via fetch &ndash;&gt;-->
<!--<script th:inline="javascript">-->
<!--    /*<![CDATA[*/-->
<!--    const form = document.getElementById('chat-form');-->
<!--    const log  = document.getElementById('log');-->

<!--    form.addEventListener('submit', async (e) => {-->
<!--        e.preventDefault();                          // stop real navigation-->
<!--        const msg = document.getElementById('msg').value.trim();-->
<!--        if (!msg) return;-->

<!--        // show user message-->
<!--        log.textContent += `You: ${msg}\n`;-->

<!--        // fire a POST /api-->
<!--        const resp = await fetch(/*[[ @{/api} ]]*/, {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({ message: msg })-->
<!--        });-->

<!--        const body = await resp.json();-->
<!--        log.textContent += `Bot: ${JSON.stringify(body)}\n\n`;-->


<!--        // clear input-->
<!--        document.getElementById('msg').value = '';-->
<!--    });-->
<!--    /*]]>*/-->
<!--</script>-->
<!--</body>-->
<!--</html>-->



<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Mortgage Chatbot</title>
    <!-- Bootswatch Cosmo theme -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/cosmo/bootstrap.min.css"
            rel="stylesheet"
            crossorigin="anonymous"
    />
    <style>
        body {
            background: url('/images/background5.jpg') no-repeat center center fixed;
            background-size: cover;
        }
    </style>
</head>
<body class="bg-light">

<!-- navbar -->
<!--<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">-->
<nav class="navbar navbar-expand-lg bg-transparent mb-4">
    <div class="container">
        <a class="navbar-brand" th:href="@{/}">Homebuying Assistant</a>
        <div class="navbar-nav">
            <a class="nav-link active" th:href="@{/chat}">Chat</a>
            <a class="nav-link" th:href="@{/quotes}">Quotes</a>
            <a class="nav-link" th:href="@{/calculator}">Calculator</a>
            <!-- etc… -->
        </div>
    </div>
</nav>

<div class="container">

    <!-- back to home -->
    <a th:href="@{/}" class="btn btn-outline-secondary mb-3">
        ← Home
    </a>

    <h1 class="mb-4">Mortgage Chatbot</h1>

    <!-- translucent panel -->
    <div class="p-4 mb-4 bg-white bg-opacity-75 rounded shadow-sm">

        <!-- optional GIF avatar: place chatbot.gif in src/main/resources/static/images/ -->
        <div class="text-center mb-4">
            <img
                    th:src="@{/images/chatbot.gif}"
                    alt="Chatbot Avatar"
                    class="img-fluid"
                    style="max-height: 200px;"
            />
        </div>

        <!-- chat input -->
        <form id="chat-form" class="row g-2 mb-3">
            <div class="col">
                <input
                        type="text"
                        id="msg"
                        class="form-control"
                        placeholder="Type your question…"
                        autocomplete="off"
                />
            </div>
            <div class="col-auto">
                <button type="submit" class="btn btn-primary">Send</button>
            </div>
        </form>

        <!-- chat log -->
        <div
                id="log"
                class="border rounded p-3"
                style="height: 300px; overflow-y: auto; background: #f8f9fa;"
        ></div>

    </div>
    <!-- /translucent panel -->

</div>

<!-- chat‐post script -->
<script th:inline="javascript">
    /*<![CDATA[*/
    const form = document.getElementById('chat-form');
    const log  = document.getElementById('log');

    form.addEventListener('submit', async e => {
        e.preventDefault();
        const msg = document.getElementById('msg').value.trim();
        if (!msg) return;

        // append user message
        log.innerHTML += `<div><strong>You:</strong> ${msg}</div>`;

        // call backend
        const resp = await fetch(/*[[ @{/api} ]]*/, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: msg })
        });
        const body = await resp.json();
        const reply = body.reply || JSON.stringify(body);

        // append bot reply
        log.innerHTML += `<div><strong>Bot:</strong> ${reply}</div>`;

        // scroll to bottom
        log.scrollTop = log.scrollHeight;

        // clear input
        document.getElementById('msg').value = '';
    });
    /*]]>*/
</script>

</body>
</html>
